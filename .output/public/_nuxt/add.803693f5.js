import{r as v,u as V,i as x,c,a as t,j as a,l as h,F as B,k as D,m as f,t as p,q as g,v as y,s as k,o as d,n as E,d as T}from"./entry.b59cf824.js";const I={class:"_add"},M=t("h2",null," 新しい練習を作ろう！ ",-1),j=t("hr",null,null,-1),F={class:"grid"},J={class:"list"},O=t("h3",null," 保存したテーマ ",-1),R={key:0,class:"alert"},U=["onClick"],z=["onClick"],A=t("hr",null,null,-1),H={key:0},L={key:1},Q={class:"item"},Y=t("label",null,"テーマ",-1),G={class:"item"},K=t("label",null,"単語（改行で単語を区切ってください）",-1),P={class:"actions"},W=t("button",null," 保存 ",-1),w="saved_tests",ee={__name:"add",setup(X){const n=v([]),o=v(null),i=v(null),r=v(null),_=v(null);function S(){const l=localStorage.getItem(w);n.value=l?JSON.parse(l):[]}function m(){localStorage.setItem(w,JSON.stringify(n.value)),window.dispatchEvent(new Event("saved_test_updated"))}function N(l){o.value=l,i.value=n.value[l].title,r.value=n.value[l].questions.join("\r");const e=window.scrollY+_.value.getBoundingClientRect().y-100;window.scrollTo(0,e)}function b(){o.value=null,i.value=null,r.value=null}function C(){const l=i.value.replace(/^\s+|\s+$/g,"");if(console.log(o.value),o.value===null&&n.value.find(s=>s.title===l)){alert("保存に失敗しました。すでに同じテーマがあります。");return}const e=[...new Set(r.value.split(/\r|\n/g).filter(s=>!!s))];if(e.length<4){alert("保存に失敗しました。少なくとも4つ異なる単語が必要です。");return}e.forEach((s,u)=>{e[u]=e[u].replace(/^\s+|\s+$/g,"")}),!isNaN(o.value)&&o.value!==null?n.value[o.value]={title:l,questions:e}:(n.value.push({title:l,questions:e}),o.value=n.value.length-1),m(),alert("保存しました")}function q(l){confirm("Are you sure")&&(n.value.splice(l,1),m())}return V({title:"編集 - 聞き取りゲーム",meta:[{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"},{name:"description",content:"自分のテーマを編集"}]}),x(()=>{S()}),(l,e)=>(d(),c("div",I,[M,j,t("div",F,[t("div",J,[O,a(n).length?h("",!0):(d(),c("div",R," データがありません ")),(d(!0),c(B,null,D(a(n),(s,u)=>(d(),c("div",{key:`test_${u}`,class:E(["item",{active:u===a(o)}]),onClick:$=>N(u)},[T(p(s.title)+" ",1),t("button",{type:"button",class:"small outline secondary",onClick:f($=>q(u),["stop"])}," 削除 ",8,z)],10,U))),128)),A]),t("div",{ref_key:"content",ref:_,class:"content"},[t("form",{onSubmit:e[3]||(e[3]=f(s=>C(),["prevent"]))},[a(o)!==null?(d(),c("h3",H," テーマ「"+p(a(i))+"」を編集 ",1)):(d(),c("h3",L," 新しいテーマを編集 ")),t("div",Q,[Y,g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>k(i)?i.value=s:null),required:""},null,512),[[y,a(i)]])]),t("div",G,[K,g(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>k(r)?r.value=s:null),required:""},null,512),[[y,a(r)]])]),t("div",P,[a(o)!==null?(d(),c("button",{key:0,type:"button",class:"outline",onClick:e[2]||(e[2]=s=>b())}," 新しいのを作る ")):h("",!0),W])],32)],512)])]))}};export{ee as default};
