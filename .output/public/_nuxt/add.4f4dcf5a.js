import{g as V,r as _,j as E,k as M,w as I,l as j,o as u,a as e,m as a,c as d,x as g,n as z,s as A,d as F,t as y,q as w,F as J,y as k,z as S,A as N}from"./entry.11ebbf07.js";import{u as L}from"./index.66c1c13c.js";const O={class:"main _add"},R=e("h2",null," 新しい練習を作ろう！ ",-1),U=e("div",null," 作成したデータはこのブラウザに保存されるので、自分しか見ることができません。 ",-1),Q=e("hr",null,null,-1),Y={class:"grid"},G={class:"list"},H=e("h3",null," 保存したテーマ ",-1),K={key:0,class:"alert"},P=["onClick"],W=["onClick"],X=e("hr",null,null,-1),Z={key:0},ee={key:1},te={class:"item"},se=e("label",null,"テーマ",-1),le={class:"item"},ne=e("label",null,"単語（改行で単語を区切ってください）",-1),oe={class:"actions"},ae=e("button",null," 保存 ",-1),p="編集 - 聞き取りゲーム",m="自分のテーマを編集",C="saved_tests",re={__name:"add",setup(ie){const T=V("pTitle");T.value="新しい練習を作ろう！",L({title:p,description:m,ogTitle:p,ogDescription:m,twitterTitle:p,twitterDescription:m});const l=_([]),n=_(null),i=_(null),c=_(null),f=_(null);function b(){const s=localStorage.getItem(C);l.value=s?JSON.parse(s):[]}function h(){localStorage.setItem(C,JSON.stringify(l.value)),window.dispatchEvent(new Event("saved_test_updated"))}function q(s){n.value=s,i.value=l.value[s].title,c.value=l.value[s].questions.join("\r");const t=window.scrollY+f.value.getBoundingClientRect().y-100;window.scrollTo(0,t)}function x(){n.value=null,i.value=null,c.value=null}function $(){const s=i.value.replace(/^\s+|\s+$/g,"");if(console.log(n.value),n.value===null&&l.value.find(r=>r.title===s)){alert("保存に失敗しました。すでに同じテーマがあります。");return}const t=[...new Set(c.value.split(/\r|\n/g).filter(r=>!!r))];if(t.length<4){alert("保存に失敗しました。少なくとも4つ異なる単語が必要です。");return}t.forEach((r,o)=>{t[o]=t[o].replace(/^\s+|\s+$/g,"")}),!isNaN(n.value)&&n.value!==null?l.value[n.value]={title:s,questions:t}:(l.value.push({title:s,questions:t}),n.value=l.value.length-1),h(),alert("保存しました")}function D(s){confirm("Are you sure")&&(l.value.splice(s,1),h())}return E(()=>{b()}),(s,t)=>{const r=j;return u(),M(r,{name:"default"},{default:I(()=>[e("div",O,[R,U,Q,e("div",Y,[e("div",G,[H,a(l).length?g("",!0):(u(),d("div",K," データがありません ")),(u(!0),d(J,null,z(a(l),(o,v)=>(u(),d("div",{key:`test_${v}`,class:A(["item",{active:v===a(n)}]),onClick:B=>q(v)},[F(y(o.title)+" ",1),e("button",{type:"button",class:"small outline secondary",onClick:w(B=>D(v),["stop"])}," 削除 ",8,W)],10,P))),128)),X]),e("div",{ref_key:"content",ref:f,class:"content"},[e("form",{onSubmit:t[3]||(t[3]=w(o=>$(),["prevent"]))},[a(n)!==null?(u(),d("h3",Z," テーマ「"+y(a(i))+"」を編集 ",1)):(u(),d("h3",ee," 新しいテーマを編集 ")),e("div",te,[se,k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>N(i)?i.value=o:null),required:""},null,512),[[S,a(i)]])]),e("div",le,[ne,k(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>N(c)?c.value=o:null),required:""},null,512),[[S,a(c)]])]),e("div",oe,[a(n)!==null?(u(),d("button",{key:0,type:"button",class:"outline secondary",onClick:t[2]||(t[2]=o=>x())}," 新しいのを作る ")):g("",!0),ae])],32)],512)])])]),_:1})}}};export{re as default};
